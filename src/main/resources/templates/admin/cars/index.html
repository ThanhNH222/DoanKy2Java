<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Car Management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/index.css}">
</head>
<body>
<!-- Sidebar -->
<div class="sidebar">
    <h4>🚗 Car Rental</h4>
    <a href="/admin">📊 Dashboard</a>
    <a href="/admin/cars" class="active">🚘 Cars</a>
    <a href="/admin/orders">👥 Rental Orders</a>
</div>

<!-- Main content -->
<div class="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>🚗 Car List</h2>
        <div>
            <a th:href="@{/admin/cars}" class="btn btn-secondary btn-soft me-2">⬅ Back</a>
            <a th:href="@{/admin/cars/create}" class="btn btn-success btn-soft">+ Add New Car</a>
        </div>
    </div>

    <!-- Flash messages -->
    <div th:if="${success}" class="alert alert-success rounded-3" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-danger rounded-3" th:text="${error}"></div>

    <!-- Search -->
    <form class="row mb-4" method="get" th:action="@{/admin/cars}">
        <div class="col-md-4">
            <input type="text" class="form-control rounded-3" name="q" placeholder="🔍 Search..." th:value="${param.q}">
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary btn-soft w-100">Search</button>
        </div>
    </form>

    <!-- Table -->
    <div class="card-dark p-3">
        <div class="table-responsive">
            <table class="table table-dark table-hover align-middle mb-0">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Image</th>
                    <th>Name</th>
                    <th>License Plate</th>
                    <th>Seats</th>
                    <th>Price/Day</th>
                    <th>Deposit</th>
                    <th>Description</th>
                    <th class="text-center">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="car : ${cars}">
                    <td th:text="${car.id}"></td>
                    <td><img th:src="@{${car.imageUrl}}" alt="Car Image" style="width:100px;height:auto;"></td>
                    <td th:text="${car.name}"></td>
                    <td th:text="${car.licensePlate}"></td>
                    <td th:text="${car.seatNumber}"></td>
                    <td th:text="${#numbers.formatDecimal(car.pricePerDay, 1, 'POINT', 2, 'NONE')}"></td>
                    <td th:text="${#numbers.formatDecimal(car.depositAmount, 1, 'POINT', 2, 'NONE')}"></td>
                    <td th:text="${car.description}"></td>
                    <td class="text-center">
                        <a th:href="@{'/admin/cars/' + ${car.id} + '/edit'}" class="btn btn-warning btn-sm btn-soft me-2">✏️ Edit</a>
                        <form th:action="@{'/admin/cars/' + ${car.id} + '/delete'}" method="post" style="display:inline">
                            <button type="submit" class="btn btn-danger btn-sm btn-soft" onclick="return confirm('Are you sure?')">🗑 Delete</button>
                        </form>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(cars)}">
                    <td colspan="9" class="text-center text-muted">No cars available</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
